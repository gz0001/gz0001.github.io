import{V as r,E as $,a as ee,S as te,C as ne,P as oe,O as ae,b as re,c as se,d as ie,M as E,H as ce,D as de,G as le,B as me,e as we,f as he,I as ue,T as pe,g as F,h as ge,i as z,L as B,j as R,W as fe,A as Me,X as ye,k as be,R as ve,l as je,m as Ce,n as Se}from"./STLLoader-c0068ad8.js";let C,u,d,l,y,b,v,x,P,S;const A=[];let f,h;const g=[],Y=[[new r(-10,0,10),new r(-5,5,5),new r(5,5,5),new r(5,-5,5),new r(10,0,10),new r(-10,0,10)],[new r(-10,0,-20),new r(50,10,10)]],Le=new Se,N=new $(0,0,10,5);let T;const X=new r,J=[],k=new ee;Ee();function Ee(){var W;C=document.createElement("div"),document.body.appendChild(C),d=new te,d.background=new ne("skyblue"),u=new oe(50,window.innerWidth/window.innerHeight,.1,2e3),u.position.set(10,10,10),f=new ae(u,C),f.target.set(0,1.6,0),f.update();const t=new re(6,6),o=new se({opacity:.25,blending:ie,transparent:!1}),a=new E(t,o);a.rotation.x=-Math.PI/2,a.receiveShadow=!0,d.add(a),d.add(new ce(12369084,10855845,3));const n=new de("0xffffff",3);n.position.set(0,6,0),n.castShadow=!0,n.shadow.camera.top=3,n.shadow.camera.bottom=-3,n.shadow.camera.right=3,n.shadow.camera.left=-3,n.shadow.mapSize.set(4096,4096),d.add(n),h=new le,d.add(h);const m=[new me(.2,.2,.2),new we(.2,.2,64),new he(.2,.2,.2,64),new ue(.2,8),new pe(.2,.04,64,32)];for(let i=0;i<3;i++){const s=m[Math.floor(Math.random()*m.length)],c=new F({color:Math.random()*16777215,roughness:.7,metalness:0}),e=new E(s,c);e.position.x=Math.random()*4-2,e.position.y=Math.random()*2,e.position.z=Math.random()*4-2,e.rotation.x=Math.random()*2*Math.PI,e.rotation.y=Math.random()*2*Math.PI,e.rotation.z=Math.random()*2*Math.PI,e.scale.setScalar(Math.random()+.5),e.castShadow=!0,e.receiveShadow=!0,h.add(e),g.push(e)}new r(-10,0,10),new r(-5,5,5),new r(5,5,5),new r(5,-5,5),new r(10,0,10),new r(-10,0,10),Y.map(i=>{const s=new ge(i),c=new z().setFromPoints(s.getPoints(50)),e=new B({color:16777215}),D=new R(c,e);d.add(D),J.push(s)}),T=new R(new z().setFromPoints(N.getSpacedPoints(100)),new B({color:"yellow"})),d.add(T);let p=new r;document.querySelectorAll(".nav-item").forEach(i=>{i.addEventListener("dragend",s=>{p.set(s.clientX/window.innerWidth*2-1,-(s.clientY/window.innerHeight)*2+1,.9),p.unproject(u);const c=i.getAttribute("data-type"),e=m[c],D=new F({color:Math.random()*16777215,roughness:.7,metalness:0}),w=new E(e,D);w.position.x=p.x,w.position.y=p.y,w.position.z=p.z,w.rotation.x=Math.random()*2*Math.PI,w.rotation.y=Math.random()*2*Math.PI,w.rotation.z=Math.random()*2*Math.PI,w.scale.setScalar(Math.random()+.5),w.castShadow=!0,w.receiveShadow=!0,h.add(w),g.push(w)})}),l=new fe({antialias:!0,preserveDrawingBuffer:!0}),l.setPixelRatio(window.devicePixelRatio),l.setSize(window.innerWidth,window.innerHeight),l.setAnimationLoop(I),l.shadowMap.enabled=!0,l.xr.enabled=!0,C.appendChild(l.domElement),y=l.xr.getController(0),y.addEventListener("selectstart",q),y.addEventListener("selectend",V),d.add(y),b=l.xr.getController(1),b.addEventListener("selectstart",q),b.addEventListener("selectend",V),d.add(b);const O=new Me(1e3);d.add(O);const j=new ye;x=l.xr.getControllerGrip(0),x.add(j.createControllerModel(x)),d.add(x),P=l.xr.getControllerGrip(1),P.add(j.createControllerModel(P)),d.add(P),v=new be([...g],u,l.domElement),v.rotateSpeed=2,v.addEventListener("drag",I),v.addEventListener("dragstart",function(){f.enabled=!1}),v.addEventListener("dragend",function(){f.enabled=!0});const L=new z().setFromPoints([new r(0,0,0),new r(0,0,-1)]),M=new R(L);M.name="line",M.scale.z=5,y.add(M.clone()),b.add(M.clone()),S=new ve,window.addEventListener("resize",xe),document.addEventListener("click",Ge);const H=C.querySelector("canvas");H&&H.addEventListener("dragover",i=>{i.preventDefault()});const Q=new je,G=document.querySelector("#file");G==null||G.addEventListener("change",i=>{Q.load(URL.createObjectURL(i.target.files[0]),s=>{const c=new Ce({color:Math.random()*16777215,specular:1118481,shininess:200}),e=new E(s,c);e.position.x=Math.random()*4-2,e.position.y=Math.random()*2,e.position.z=Math.random()*4-2,e.scale.setScalar(Math.random()+.5),e.castShadow=!0,e.receiveShadow=!0,s.center(),h.add(e),g.push(e)})});const Z=()=>{let i;try{const s="image/jpeg",c="image/octet-stream";i=l.domElement.toDataURL(s),_(i.replace(s,c),"snapshot.jpg")}catch(s){console.log(s);return}},_=(i,s)=>{const c=document.createElement("a");typeof c.download=="string"?(document.body.appendChild(c),c.download=s,c.href=i,c.click(),document.body.removeChild(c)):location.replace(uri)};(W=document.querySelector("#snapshot button"))==null||W.addEventListener("click",Z)}function xe(){u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)}function q(t){const o=t.target,a=K(o);if(a.length>0){const m=a[0].object;m.material.emissive.b=1,o.attach(m),o.userData.selected=m}o.userData.targetRayMode=t.data.targetRayMode}function V(t){const o=t.target;if(o.userData.selected!==void 0){const a=o.userData.selected;a.material.emissive.b=0,h.attach(a),o.userData.selected=void 0}}function K(t){return t.updateMatrixWorld(),S.setFromXRController(t),S.intersectObjects(h.children,!1)}function U(t){if(t.userData.targetRayMode==="screen"||t.userData.selected!==void 0)return;const o=t.getObjectByName("line"),a=K(t);if(a.length>0){const n=a[0],m=n.object;m.material.emissive.r=1,A.push(m),o.scale.z=n.distance}else o.scale.z=5}function Pe(){for(;A.length;){const t=A.pop();t.material.emissive.r=0}}function Ge(t){if(!t.target.closest("canvas"))return;t.preventDefault();const o=v.getObjects();o.length=0,k.x=t.clientX/window.innerWidth*2-1,k.y=-(t.clientY/window.innerHeight)*2+1,S.setFromCamera(k,u);const a=S.intersectObjects(g,!0);if(a.length>0){const n=a[0].object;h.children.includes(n)===!0?(n.material.emissive.set(0),d.attach(n)):(n.material.emissive.set(11184810),h.attach(n)),f.transformGroup=!0,o.push(h)}h.children.length===0&&(f.transformGroup=!1,o.push(...g)),I()}function De(){J.forEach((a,n)=>{const m=g[n],p=Y[n].length+1,j=Date.now()/(n*500+1e3)%p/p,L=a.getPointAt(j);m.position.copy(L);const M=a.getTangentAt(j).normalize();m.lookAt(L.clone().add(M))});let t=Le.getElapsedTime()*.5%1;const o=g[2];N.getPointAt(t,X),o.position.copy(X)}function I(){Pe(),U(y),U(b),De(),l.render(d,u)}
